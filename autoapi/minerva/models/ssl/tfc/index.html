

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>minerva.models.ssl.tfc &mdash; minerva  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="minerva.models.ssl.tnc" href="../tnc/index.html" />
    <link rel="prev" title="minerva.models.ssl.simclr" href="../simclr/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            minerva
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../design.html">Minerva Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../tutorials.html">Examples and Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing.html">Contributing to Minerva</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../api.html">Programming Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">minerva</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../../index.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../analysis/index.html">minerva.analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../data/index.html">minerva.data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../losses/index.html">minerva.losses</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html">minerva.models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimizers/index.html">minerva.optimizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../pipelines/index.html">minerva.pipelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../samplers/index.html">minerva.samplers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../transforms/index.html">minerva.transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/index.html">minerva.utils</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">minerva</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../../api.html">Programming Reference</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">minerva</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">minerva.models</a></li>
          <li class="breadcrumb-item"><a href="../index.html">minerva.models.ssl</a></li>
      <li class="breadcrumb-item active">minerva.models.ssl.tfc</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/autoapi/minerva/models/ssl/tfc/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-minerva.models.ssl.tfc">
<span id="minerva-models-ssl-tfc"></span><h1>minerva.models.ssl.tfc<a class="headerlink" href="#module-minerva.models.ssl.tfc" title="Link to this heading"></a></h1>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#minerva.models.ssl.tfc.TFC_Model" title="minerva.models.ssl.tfc.TFC_Model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TFC_Model</span></code></a></p></td>
<td><p>Main class for the Temporal-Frequency Convolutional (TFC) model.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">minerva.models.ssl.tfc.</span></span><span class="sig-name descname"><span class="pre">TFC_Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TS_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_encoding_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backbone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pipeline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency_encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_projector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency_projector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_1_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/minerva/models/ssl/tfc.html#TFC_Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">lightning.LightningModule</span></code></p>
<p>Main class for the Temporal-Frequency Convolutional (TFC) model.
The model is composed of a backbone and a prediction head. The backbone is (by default) a Convolutional Neural Network (CNN) that extracts features
from the input data in the time domain and frequency domain. The prediction head is a fully connected layer that classifies the features extracted
by the backbone in the given classes.
This class can be trained with a supervised learning approach or with a self-supervised learning approach, or even with single pipelines.
This class implements the training and validation steps for the model, as well as the forward method and the configuration of the optimizer, as
requeired by pytorch-lightning.</p>
<p>The constructor of the TFC_Model class.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>input_channels: int</dt><dd><p>The number of channels in the input data</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>TS_length: int</dt><dd><p>The number of time steps in the input data</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>num_classes: Optional[int]</dt><dd><p>The number of downstream classes in the dataset, if none, the model is trained in a self-supervised learning approach</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>single_encoding_size: int</dt><dd><p>The size of the encoding in the latent space of frequency or time domain individually</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>backbone: Optional[Union[TFC_Backbone, LoadableModule]]</dt><dd><p>The backbone of the model. If None, a default backbone is created with the encoders and projectors provided. If a LoadableModule is provided, it is used as the backbone.
If provided, make sure you really know what you are doing.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>pred_head: Union[bool, nn.Module]</dt><dd><p>If True, a prediction head (MLP) is added to the model. If False or None, the model is trained in a self-supervised learning approach. If a nn.Module is provided, it is used as the prediction head</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>loss: _Loss</dt><dd><p>The loss function to be used in the training step. If None, the ntxent_poly is used for pretrain or the CrossEntropyLoss is used for downstream</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>learning_rate: float</dt><dd><p>The learning rate of the optimizer</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>transform: _Transform</dt><dd><p>The transformation to be applied to the input data. If None, a default transformation is applied that includes data augmentation and frequency domain transformation</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>device: str</dt><dd><p>The device to be used in the training of the model, default is ‘cuda’</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>batch_size: int</dt><dd><p>The batch size of the model</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>pipeline: str</dt><dd><dl class="simple">
<dt>The pipeline to be used in the training of the model. It can be ‘both’, ‘time’ or ‘freq’. Default is ‘both’. If ‘both’, the model is trained with both time and frequency domain data as default described in tfc paper.</dt><dd><p>If ‘time’, the model is trained with only time domain data. If ‘freq’, the model is trained with only frequency domain data obtained by fft. At these scenarios, the input data must have the time and frequency domain
but the prediction head will be used only for the selected one. Also is necesssary to adapt the prediction head input half size of expected (only single_encoding_size instead of single_encoding_size*2)</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>time_encoder: Optional[nn.Module]</dt><dd><p>The encoder to be used in the time domain. If None, a default encoder is used. time_encoder can not be passed if backbone is passed.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>frequency_encoder: Optional[nn.Module]</dt><dd><p>The encoder to be used in the frequency domain. If None, a default encoder is used. frequency_encoder can not be passed if backbone is passed.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>time_projector: Optional[nn.Module]</dt><dd><p>The projector to be used in the time domain. If None, a default projector is used. time_projector can not be passed if backbone is passed.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>frequency_projector: Optional[nn.Module]</dt><dd><p>The projector to be used in the frequency domain. If None, a default projector is used. frequency_projector can not be passed if backbone is passed.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>train_metrics<span class="classifier">Dict[str, Metric], optional</span></dt><dd><p>The metrics to be used during training, by default None</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>val_metrics<span class="classifier">Dict[str, Metric], optional</span></dt><dd><p>The metrics to be used during validation, by default None</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>test_metrics<span class="classifier">Dict[str, Metric], optional</span></dt><dd><p>The metrics to be used during testing, by default None</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>batch_1_correction: bool</dt><dd><p>If True, some parts of the architecture are adapted to
work with batch size 1. Default is False, which means
that the model is not adapted to work with batch size 1.</p>
</dd>
</dl>
</li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model._compute_metrics">
<span class="sig-name descname"><span class="pre">_compute_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_hat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/minerva/models/ssl/tfc.html#TFC_Model._compute_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model._compute_metrics" title="Link to this definition"></a></dt>
<dd><p>Calculate the metrics for the given step.</p>
<section id="id1">
<h4>Parameters<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>y_hat<span class="classifier">torch.Tensor</span></dt><dd><p>The output data from the forward pass.</p>
</dd>
<dt>y<span class="classifier">torch.Tensor</span></dt><dd><p>The input data/label.</p>
</dd>
<dt>step_name<span class="classifier">str</span></dt><dd><p>Name of the step. It will be used to get the metrics from the
<cite>self.metrics</cite> attribute.</p>
</dd>
</dl>
</section>
<section id="returns">
<h4>Returns<a class="headerlink" href="#returns" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>Dict[str, torch.Tensor]</dt><dd><p>A dictionary with the metrics values.</p>
</dd>
</dl>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_hat</strong> (<em>torch.Tensor</em>)</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em>)</p></li>
<li><p><strong>step_name</strong> (<em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/minerva/models/ssl/tfc.html#TFC_Model.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model.configure_optimizers" title="Link to this definition"></a></dt>
<dd><p>Function that configures the optimizer of the model. It returns an Adam optimizer with the learning rate defined in the constructor.</p>
<section id="id2">
<h4>Returns<a class="headerlink" href="#id2" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>Optimizer</dt><dd><p>The optimizer of the model</p>
</dd>
</dl>
</li>
</ul>
</section>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.optim.Optimizer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/minerva/models/ssl/tfc.html#TFC_Model.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model.forward" title="Link to this definition"></a></dt>
<dd><p>The forward method of the model. It receives the input data in the time domain and frequency domain and returns the prediction of the model.</p>
<section id="id3">
<h4>Parameters<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>x: torch.Tensor</dt><dd><p>The input data</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>all: bool</dt><dd><p>If True, the method returns the prediction of the model and the features extracted by the backbone. If False, only the prediction is returned</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="id4">
<h4>Returns<a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>torch.Tensor</dt><dd><p>If the model has a prediction head and parameter “all” is False, the method returns the prediction of the model, a tensor with the shape (batch_size, num_classes)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>tuple</dt><dd><p>If the model has not a prediction head, the method returns a tuple with the features extracted by the backbone, h_t, z_t, h_f, z_f respectively.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>tuple</dt><dd><p>If the model has a prediction head and parameter “all” is True, the method returns a tuple with the prediction of the model and the features extracted by the backbone, following the format prediction, h_t, z_t, h_f, z_f.</p>
</dd>
</dl>
</li>
</ul>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>)</p></li>
<li><p><strong>all</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0003</span></em><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model.learning_rate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model.metrics" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model.num_classes">
<span class="sig-name descname"><span class="pre">num_classes</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model.num_classes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model.pipeline">
<span class="sig-name descname"><span class="pre">pipeline</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'both'</span></em><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model.pipeline" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model.predict_step">
<span class="sig-name descname"><span class="pre">predict_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/minerva/models/ssl/tfc.html#TFC_Model.predict_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model.predict_step" title="Link to this definition"></a></dt>
<dd><p>The predict step of the model. It receives a batch of data and returns the torch tensor of probability of prediction or the latent space if a prediction head is not provided.</p>
<section id="id5">
<h4>Parameters<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>batch: Tuple[torch.Tensor, torch.Tensor]</dt><dd><p>A tuple with the input data and its labels as X, Y</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>batch_index: int</dt><dd><p>The index of the batch in the dataset (not used in this method)</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="id6">
<h4>Returns<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>loss</dt><dd><p>The loss of the model in this test step</p>
</dd>
</dl>
</li>
</ul>
<p>can also return f1 score and accuracy if a prediction head is provided:
- Tuple[loss, f1, accuracy] types: Tuple[torch.Tensor, float, float]</p>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em>)</p></li>
<li><p><strong>batch_index</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/minerva/models/ssl/tfc.html#TFC_Model.test_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model.test_step" title="Link to this definition"></a></dt>
<dd><p>The test step of the model. It receives a batch of data and returns the loss of the model and f1 score and accuracy if a prediction head is provided.</p>
<section id="id7">
<h4>Parameters<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>batch: Tuple[torch.Tensor, torch.Tensor]</dt><dd><p>A tuple with the input data and its labels as X, Y</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>batch_index: int</dt><dd><p>The index of the batch in the dataset (not used in this method)</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="id8">
<h4>Returns<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>loss</dt><dd><p>The loss of the model in this test step</p>
</dd>
</dl>
</li>
</ul>
<p>can also return f1 score and accuracy if a prediction head is provided:
- Tuple[loss, f1, accuracy] types: Tuple[torch.Tensor, float, float]</p>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em>)</p></li>
<li><p><strong>batch_index</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/minerva/models/ssl/tfc.html#TFC_Model.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model.training_step" title="Link to this definition"></a></dt>
<dd><p>The training step of the model. It receives a batch of data and returns the loss of the model.</p>
<section id="id9">
<h4>Parameters<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>batch: Tuple[torch.Tensor, torch.Tensor]</dt><dd><p>A tuple with the input data and its labels as X, Y</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>batch_index: int</dt><dd><p>The index of the batch in the dataset (not used in this method)</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="id10">
<h4>Returns<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>loss</dt><dd><p>The loss of the model in this training step</p>
</dd>
</dl>
</li>
</ul>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em>)</p></li>
<li><p><strong>batch_index</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="minerva.models.ssl.tfc.TFC_Model.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/minerva/models/ssl/tfc.html#TFC_Model.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#minerva.models.ssl.tfc.TFC_Model.validation_step" title="Link to this definition"></a></dt>
<dd><p>The validation step of the model. It receives a batch of data and returns the loss of the model.</p>
<section id="id11">
<h4>Parameters<a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>batch: Tuple[torch.Tensor, torch.Tensor]</dt><dd><p>A tuple with the input data and its labels as X, Y</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>batch_index: int</dt><dd><p>The index of the batch in the dataset (not used in this method)</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="id12">
<h4>Returns<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>loss</dt><dd><p>The loss of the model in this validation step</p>
</dd>
</dl>
</li>
</ul>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Tuple</em><em>[</em><em>torch.Tensor</em><em>, </em><em>torch.Tensor</em><em>]</em>)</p></li>
<li><p><strong>batch_index</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_channels</strong> (<em>int</em>)</p></li>
<li><p><strong>TS_length</strong> (<em>int</em>)</p></li>
<li><p><strong>num_classes</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>single_encoding_size</strong> (<em>int</em>)</p></li>
<li><p><strong>backbone</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><a class="reference internal" href="../../nets/tfc/index.html#minerva.models.nets.tfc.TFC_Backbone" title="minerva.models.nets.tfc.TFC_Backbone"><em>minerva.models.nets.tfc.TFC_Backbone</em></a><em>, </em><a class="reference internal" href="../../loaders/index.html#minerva.models.loaders.LoadableModule" title="minerva.models.loaders.LoadableModule"><em>minerva.models.loaders.LoadableModule</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>pred_head</strong> (<em>Union</em><em>[</em><em>bool</em><em>, </em><em>torch.nn.Module</em><em>]</em>)</p></li>
<li><p><strong>loss</strong> (<em>torch.nn.modules.loss._Loss</em>)</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>)</p></li>
<li><p><strong>transform</strong> (<a class="reference internal" href="../../../transforms/transform/index.html#minerva.transforms.transform._Transform" title="minerva.transforms.transform._Transform"><em>minerva.transforms.transform._Transform</em></a>)</p></li>
<li><p><strong>device</strong> (<em>str</em>)</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>)</p></li>
<li><p><strong>pipeline</strong> (<em>str</em>)</p></li>
<li><p><strong>time_encoder</strong> (<em>Optional</em><em>[</em><em>torch.nn.Module</em><em>]</em>)</p></li>
<li><p><strong>frequency_encoder</strong> (<em>Optional</em><em>[</em><em>torch.nn.Module</em><em>]</em>)</p></li>
<li><p><strong>time_projector</strong> (<em>Optional</em><em>[</em><em>torch.nn.Module</em><em>]</em>)</p></li>
<li><p><strong>frequency_projector</strong> (<em>Optional</em><em>[</em><em>torch.nn.Module</em><em>]</em>)</p></li>
<li><p><strong>train_metrics</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>torchmetrics.Metric</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>val_metrics</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>torchmetrics.Metric</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>test_metrics</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>torchmetrics.Metric</em><em>]</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../simclr/index.html" class="btn btn-neutral float-left" title="minerva.models.ssl.simclr" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tnc/index.html" class="btn btn-neutral float-right" title="minerva.models.ssl.tnc" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Unicamp.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>